[tool.ruff]
include = [
    "./apps/prairielearn/python/**.py",
    "./graders/**/*.py",
    "./exampleCourse/**/*.py",
    "./testCourse/**/*.py"
]
exclude = [
    # These files are intentionally not parseable as Python.
    "./exampleCourse/questions/demo/autograder/codeUpload/submitted_code_samples/fib_error_binary_file/fib.py",
    "./exampleCourse/questions/demo/autograder/codeUpload/submitted_code_samples/fib_error_large_text_file/fib.py",
    # Files related to the Python autograder will often intentionally appear
    # broken in isolation. We'll exclude these files from linting.
    "exampleCourse/questions/**/tests/initial_code.py",
    "exampleCourse/questions/**/tests/trailing_code.py"
]
target-version = "py310"

[tool.ruff.lint]
extend-select = ["I"]

[tool.ruff.lint.per-file-ignores]
# Files related to the Python autograder will often intentionally appear
# broken in isolation. We'll allow specific errors in these files to
# account for that.
#
# - F401: module imported but unused
# - F821: undefined name
# - F841: local variable name is assigned to but never used
"exampleCourse/questions/**/tests/setup_code.py" = ["F401", "F821"]
"exampleCourse/questions/**/tests/leading_code.py" = ["F401", "F821", "F841"]
"exampleCourse/questions/**/tests/ans.py" = ["F821"]
# Questions commonly use "ambiguous variable names" to represent specific
# concepts, e.g. I for an identity matrix. We'll allow these to be used in
# questions.
"exampleCourse/questions/**/*.py" = ["E741"]
# The zygote specifically uses imports in strange places to facilitate the
# preloading of commonly-used modules.
"zygote.py" = ["E402", "F401"]

[tool.ruff.format]
exclude = [
    "./exampleCourse/questions/demo/autograder/python/leadingTrailing/tests/trailing_code.py",
    "./exampleCourse/questions/demo/autograder/python/square/tests/initial_code.py"
]

[tool.pyright]
include = [
    "./apps/prairielearn/python/elements/pl-answer-panel",
    "./apps/prairielearn/python/elements/pl-big-o-input",
    "./apps/prairielearn/python/elements/pl-card",
    "./apps/prairielearn/python/elements/pl-code",
    "./apps/prairielearn/python/elements/pl-dataframe",
    "./apps/prairielearn/python/elements/pl-excalidraw",
    "./apps/prairielearn/python/elements/pl-external-grader-results",
    "./apps/prairielearn/python/elements/pl-external-grader-variables",
    "./apps/prairielearn/python/elements/pl-figure",
    "./apps/prairielearn/python/elements/pl-file-download",
    "./apps/prairielearn/python/elements/pl-file-editor",
    "./apps/prairielearn/python/elements/pl-file-preview",
    "./apps/prairielearn/python/elements/pl-file-upload",
    "./apps/prairielearn/python/elements/pl-graph",
    "./apps/prairielearn/python/elements/pl-hidden-hints",
    "./apps/prairielearn/python/elements/pl-hide-in-manual-grading",
    "./apps/prairielearn/python/elements/pl-hide-in-panel",
    "./apps/prairielearn/python/elements/pl-integer-input",
    "./apps/prairielearn/python/elements/pl-manual-grading-only",
    "./apps/prairielearn/python/elements/pl-matrix-latex",
    "./apps/prairielearn/python/elements/pl-multiple-choice",
    "./apps/prairielearn/python/elements/pl-number-input",
    "./apps/prairielearn/python/elements/pl-overlay",
    "./apps/prairielearn/python/elements/pl-order-blocks",
    "./apps/prairielearn/python/elements/pl-python-variable",
    "./apps/prairielearn/python/elements/pl-question-panel",
    "./apps/prairielearn/python/elements/pl-string-input",
    "./apps/prairielearn/python/elements/pl-submission-panel",
    "./apps/prairielearn/python/elements/pl-symbolic-input",
    "./apps/prairielearn/python/elements/pl-template",
    "./apps/prairielearn/python/elements/pl-units-input",
    "./apps/prairielearn/python/elements/pl-variable-output",
    "./apps/prairielearn/python/elements/pl-workspace",
    "./apps/prairielearn/python/elements/pl-xss-safe",
    "./apps/prairielearn/python/prairielearn/colors.py",
    "./apps/prairielearn/python/prairielearn/core.py",
    "./apps/prairielearn/python/prairielearn/internal/check_data.py",
    "./apps/prairielearn/python/prairielearn/sympy_utils.py",
    "./apps/prairielearn/python/prairielearn/internal/question_phases.py",
    "./apps/prairielearn/python/prairielearn/internal/traverse.py",
    "./apps/prairielearn/python/prairielearn/internal/zygote_utils.py",
    "./apps/prairielearn/python/zygote.py",
    "./apps/prairielearn/python/test/check_data_test.py",
    "./apps/prairielearn/python/test/colors_test.py",
    "./apps/prairielearn/python/test/sympy_utils_test.py",
    "./apps/prairielearn/python/test/conftest.py",
    "./apps/prairielearn/python/test/core_test.py",
    "./apps/prairielearn/python/test/traverse_test.py",
    "./apps/prairielearn/python/test/zygote_utils_test.py",
]
extraPaths = ["./apps/prairielearn/python"]
pythonVersion = "3.10"
reportUnnecessaryTypeIgnoreComment = "error"

[tool.pytest.ini_options]
pythonpath = [
    "apps/prairielearn/python"
]
addopts = "--cov=apps"
testpaths = [
    "apps/prairielearn/python/elements",
    "apps/prairielearn/python/test"
]
