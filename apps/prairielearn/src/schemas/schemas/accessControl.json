{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Access rule",
  "anyOf": [
    {
      "not": {}
    },
    {
      "type": "object",
      "properties": {
        "name": {
          "description": "Name for AccessControl rule",
          "type": "string"
        },
        "targets": {
          "description": "Array of (User, Access Control Group) ids this set targets",
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "enabled": {
          "description": "Whether this set of permissions is enabled",
          "type": "boolean",
          "default": true
        },
        "blockAccess": {
          "description": "Short circuit for whether the targets should have access to the assessment",
          "type": "boolean",
          "default": false
        },
        "listBeforeRelease": {
          "description": "Whether students can see the title and click into the assessment before release",
          "type": "boolean"
        },
        "dateControl": {
          "type": "object",
          "properties": {
            "enabled": {
              "type": ["boolean", "null"]
            },
            "releaseDateEnabled": {
              "description": "Whether to enable release date",
              "type": ["boolean", "null"]
            },
            "releaseDate": {
              "description": "Deadline date as ISO String",
              "type": "string"
            },
            "dueDateEnabled": {
              "description": "Whether to enable due date",
              "type": ["boolean", "null"]
            },
            "dueDate": {
              "description": "Due date as ISO String",
              "type": "string"
            },
            "earlyDeadlinesEnabled": {
              "description": "Whether to enable early deadlines",
              "type": ["boolean", "null"]
            },
            "earlyDeadlines": {
              "description": "Array of early deadlines with credit as percentages",
              "type": "array",
              "items": {
                "$ref": "#/definitions/DeadlineEntryJsonSchema"
              }
            },
            "lateDeadlinesEnabled": {
              "description": "Whether to enable late deadlines",
              "type": ["boolean", "null"]
            },
            "lateDeadlines": {
              "description": "Array of late deadlines with credit as percentages",
              "type": "array",
              "items": {
                "$ref": "#/definitions/DeadlineEntryJsonSchema"
              }
            },
            "afterLastDeadline": {
              "description": "Controls for assessment behaviour after last deadline",
              "type": "object",
              "properties": {
                "allowSubmissions": {
                  "type": "boolean"
                },
                "creditEnabled": {
                  "type": ["boolean", "null"]
                },
                "credit": {
                  "type": "number"
                }
              }
            },
            "durationMinutesEnabled": {
              "description": "Whether to enable duration minutes",
              "type": ["boolean", "null"]
            },
            "durationMinutes": {
              "description": "Desired duration limit for assessment",
              "type": "number"
            },
            "passwordEnabled": {
              "description": "Whether to enable password",
              "type": ["boolean", "null"]
            },
            "password": {
              "description": "Password for assessment",
              "type": "string"
            }
          }
        },
        "prairieTestControl": {
          "type": "object",
          "properties": {
            "enabled": {
              "description": "Whether to enable PrairieTest controls",
              "type": "boolean"
            },
            "exams": {
              "description": "Array of associated PrairieTest exam configs",
              "type": "array",
              "items": {
                "anyOf": [
                  {
                    "not": {}
                  },
                  {
                    "type": "object",
                    "required": ["examUuid"],
                    "properties": {
                      "examUuid": {
                        "description": "UUID of associated PrairieTest exam",
                        "type": "string"
                      },
                      "readOnly": {
                        "description": "Whether the exam is read-only for students",
                        "type": "boolean"
                      }
                    }
                  }
                ]
              }
            }
          }
        },
        "afterComplete": {
          "type": "object",
          "properties": {
            "hideQuestions": {
              "description": "Whether to enable settings controlling question visibility after assessment completion",
              "type": "boolean"
            },
            "hideQuestionsDateControl": {
              "description": "Settings controlling question visibility after assessment completion",
              "type": "object",
              "properties": {
                "showAgainDateEnabled": {
                  "description": "Whether to enable the ability for revealing hidden questions after assessment completion",
                  "type": ["boolean", "null"]
                },
                "showAgainDate": {
                  "description": "Date as ISO String for when to unhide questions to students after assessment completion",
                  "type": "string"
                },
                "hideAgainDateEnabled": {
                  "description": "Whether to enable the ability for re-hiding revealed questions after assessment completion",
                  "type": ["boolean", "null"]
                },
                "hideAgainDate": {
                  "description": "Date as ISO String for when to rehide questions to students after assessment completion",
                  "type": "string"
                }
              }
            },
            "hideScore": {
              "description": "Whether to enable settings controlling score visibility after assessment completion",
              "type": "boolean"
            },
            "hideScoreDateControl": {
              "description": "Settings controlling question visibility after assessment completion",
              "type": "object",
              "properties": {
                "showAgainDateEnabled": {
                  "description": "Whether to enable the ability to show hidden scores after assessment completion",
                  "type": ["boolean", "null"]
                },
                "showAgainDate": {
                  "description": "Date as ISO String for when to reveal hidden scores after assessment completion",
                  "type": "string"
                }
              }
            }
          }
        }
      }
    }
  ],
  "definitions": {
    "DeadlineEntryJsonSchema": {
      "anyOf": [
        {
          "not": {}
        },
        {
          "type": "object",
          "required": ["date", "credit"],
          "properties": {
            "date": {
              "description": "Date as ISO String for additional deadline",
              "type": "string"
            },
            "credit": {
              "description": "Amount of credit as a percent to allow",
              "type": "number"
            }
          }
        }
      ]
    }
  }
}
