<div class="form-group">
  <span class="w-100">
    <label for="js-<%= type %>-score-value-input-points" class="js-manual-grading-points">
      <%= type_label %> Points:
    </label>
    <label for="js-<%= type %>-score-value-input-percentage" class="js-manual-grading-percentage">
      <%= type_label %> Score:
    </label>
    <span class="float-right">
      <% if (rubric?.rubric_data || type == 'auto') { %>
      <span class="js-manual-grading-points js-<%= type %>-score-value-info">
        <span class="js-value-<%= type %>-points"><%= points %></span> / <%= max_points %>
      </span>
      <span class="js-manual-grading-percentage js-<%= type %>-score-value-info">
        <span class="js-value-<%= type %>-percentage"><%= points * 100 / (max_points || assessment_question.max_points) %></span>%
      </span>
      <% } %>
      <div class="btn-group btn-group-sm" role="group">
      <% if (type == 'auto' && authz_data.has_course_instance_permission_edit && !rubric?.rubric_data) { %>
      <button type="button" class="btn btn-outline-secondary js-enable-<%= type %>-score-edit js-<%= type %>-score-value-info">
        <i class="fas fa-pencil"></i>
      </button>
      <% } %>
      <% if (!locals.disable && authz_data.has_course_instance_permission_edit && course.manual_grading_visible) { %>
      <button type="button" class="btn btn-outline-secondary js-show-rubric-settings-button"
              data-rubric-type="<%= type %>">
        <i class="fas fa-list-check"></i>
      </button>
      <% } %>
      </div>
    </span>
  </span>
  <div class="js-manual-grading-points">
    <div class="input-group js-<%= type %>-score-value-input<% if (rubric?.rubric_data || type == 'auto') { %> d-none<% } %>">
      <input type="number" step="any"
             id="js-<%= type %>-score-value-input-points"
             class="form-control js-grading-score-input"
             data-rubric-active="<%= !!rubric?.rubric_data %>"
             data-rubric-starting-points="<%= rubric?.rubric_data?.starting_points %>"
             data-rubric-max-points="<%= rubric?.rubric_data?.max_points %>"
             data-rubric-min-points="<%= rubric?.rubric_data?.min_points %>"
             name="score_<%= type %>_points"
             value="<%= points %>"
             <% if (locals.disable || !authz_data.has_course_instance_permission_edit) { %>disabled<% } %> />
      <span class="input-group-append">
        <span class="input-group-text">/ <%= max_points %></span>
      </span>
    </div>
  </div>
  <div class="js-manual-grading-percentage">
    <div class="input-group js-<%= type %>-score-value-input<% if (rubric?.rubric_data || type == 'auto') { %> d-none<% } %>">
      <input type="number" step="any"
             id="js-<%= type %>-score-value-input-percentage"
             class="form-control js-grading-score-input"
             name="score_<%= type %>_percent"
             value="<%= points * 100 / (max_points || assessment_question.max_points) %>"
             <% if (locals.disable || !authz_data.has_course_instance_permission_edit) { %>disabled<% } %> />
      <span class="input-group-append">
        <span class="input-group-text">%</span>
      </span>
    </div>
  </div>
</div>
<% if (rubric?.rubric_data) { %>
<style>
  .js-selectable-rubric-item-label:has(input:checked) {
      border-color: rgba(0,0,0,.125);
      border-width: 1px;
      border-style: solid;
      background-color: var(--light);
  }
  .js-selectable-rubric-item-label p {
      margin-bottom: 0;
  }
</style>
<% (rubric?.rubric_items || []).forEach((item) => { %>
<div>
  <label class="js-selectable-rubric-item-label w-100">
    <input type="checkbox" name="rubric_item_selected_<%= type %>"
           class="js-selectable-rubric-item"
           value="<%= item.rubric_item.id %>" <%= item.grading_item ? 'checked' : '' %>
           data-rubric-item-points="<%= item.rubric_item.points %>"
           data-rubric-item-type="<%= type %>"
           data-key-binding="<%= item.rubric_item.key_binding %>">
    <span class="badge badge-info"><%= item.rubric_item.key_binding %></span>
    <span class="float-right text-<%= item.rubric_item.points >= 0 ? 'success' : 'danger' %>">
      <strong>
        <span class="js-manual-grading-points">
          [<%= (item.rubric_item.points >= 0 ? '+' : '') + item.rubric_item.points %>]
        </span>
        <span class="js-manual-grading-percentage">
          [<%= (item.rubric_item.points >= 0 ? '+' : '') + (item.rubric_item.points * 100 / (max_points || assessment_question.max_points)) %>%]
        </span>
      </strong>
    </span>
    <span>
      <div class="d-inline-block">
        <%- item.rubric_item.short_text_rendered %>
      </div>
      <div class="small text-muted">
        <%- item.rubric_item.description_rendered %>
      </div>
      <div class="small text-muted">
        <%- item.rubric_item.staff_instructions_rendered %>
      </div>
    </span>
  </label>
</div>
<% }); %>
<hr/>
<% } %>
