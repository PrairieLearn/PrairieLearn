<!DOCTYPE html>
<html>
  <head>
    <%- include('../partials/head'); %>
  </head>
  <body>
    <script>
      $(function () {
          $('[data-toggle="popover"]').popover()
      });
    </script>
    <%- include('../partials/navbar', {navPage: 'assessments'}); %>
    <div id="content" class="container">
      <div class="panel panel-primary">
        <div class="panel-heading">
          <h3 class="panel-title">Assessments</h3>
        </div>

        <table class="table table-condensed table-hover">
          <thead>
            <tr>
              <th style="width: 1%"></th>
              <th></th>
              <th class="cell-center">Available credit</th>
              <th class="cell-center">Score</th>
            </tr>
          </thead>
          <tbody>
            <% rows.forEach(function(row) { %>
            <% if (row.start_new_set) { %>
            <tr class="<%= row.assessment_set_color %>">
              <th colspan="4"><%= row.assessment_set_heading %></th>
            </tr>
            <% } %>
            <tr>
              <td style="width: 1%">
                <% if (row.multiple_instance_header) { %>
                <button class="btn btn-<%= row.assessment_set_color %> btn-xs"><%= row.label %></button>
                <% } else { %>
                <a href="<%= urlPrefix %><%= row.link %>"
                   class="btn btn-<%= row.assessment_set_color %> btn-xs" role="button">
                  <%= row.label %>
                </a>
                <% } %>
              </td>
              <td>
                <% if (row.multiple_instance_header) { %>
                <%= row.title %>
                <% } else { %>
                <a href="<%= urlPrefix %><%= row.link %>"><%= row.title %></a>
                <% } %>
              </td>
              <td class="cell-center">
                <%= row.credit_date_string %>
                <%- include('../partials/studentAccessRulesPopover', {
                    accessRules: row.access_rules,
                    assessmentSetName: row.assessment_set_name,
                    assessmentNumber: row.assessment_number,
                    }) %>
              </td>
              <td class="cell-center">
                <% if (row.multiple_instance_header) { %>
                <a href="<%= urlPrefix %><%= row.link %>" class="btn btn-primary btn-xs" role="button">New instance</a>
                <% } else { // multiple_instance_header %>
                <% if (row.assessment_instance_id) { %>
                <%- include('../partials/scorebar', {score: row.assessment_instance_score_perc}) %>
                <% } else { %>
                Not started
                <% } %>
                <% } // multiple_instance_header %>
              </td>
            </tr>
            <% }); %>
          </tbody>
        </table>
      </div>
      <% if (authz_data.mode == 'Exam') { %>
      <p>Don't see your exam? Exams for this course are only made available to students with checked-in exam reservations. See a proctor for assistance.</p>
      <% } %>
    </div>
  </body>
</html>
